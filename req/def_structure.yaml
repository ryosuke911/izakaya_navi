src:
  mobile:
    izakaya_navi:
      lib:
        main.dart:
          content: "アプリのエントリーポイント、初期設定と全体のルーティング"
          dependency:
            - lib/screens/home_screen.dart
            - lib/screens/auth_screen.dart
            - lib/services/navigation_service.dart
            - lib/config/env.dart

        config:
          env.dart:
            content: "環境変数の定義（APIキーなど）"
            dependency: []

        models:
          venue.dart:
            content: "店舗情報のデータモデル"
            dependency: []
          
          location.dart:
            content: "位置情報のデータモデル"
            dependency: []

        services:
          store_service.dart:
            content: "店舗情報の取得と管理（Foursquare Places API）"
            dependency:
              - lib/api/foursquare_api.dart
              - lib/models/venue.dart
              - lib/models/location.dart
              - lib/config/env.dart

          auth_service.dart:
            content: "Supabase認証機能の実装"
            dependency:
              - lib/backend/supabase/auth_functions.dart

          search_service.dart:
            content: |
              "検索機能の実装、条件フィルタリング
              - 詳細検索機能
                - エリア・駅名による検索
                - カテゴリによるフィルタリング（複数選択対応）
                - 詳細条件によるフィルタリング
                  - 人数での絞り込み（Places APIの詳細情報から座席数を確認）
                  - 喫煙状況での絞り込み（Places APIの詳細情報から喫煙可否を確認）
                  - オプション（飲み放題、個室）での絞り込み（Places APIの詳細情報から設備情報を確認）
                  - 営業時間での絞り込み（Places APIのopenNowと営業時間情報を使用）
                  - 予算範囲での絞り込み（Places APIのpriceLevelを使用）
                - 検索結果のソート機能（評価順、距離順）
                - フィルタリング処理の改善
                  - 各フィルター条件の適用状況のログ出力
                  - エラー発生時の具体的なメッセージ表示
                  - フィルター条件の適用順序の最適化
                  - メモリ使用量の最適化"
            dependency:
              - lib/api/places_api.dart
              - lib/models/venue.dart
              - lib/services/location_service.dart
            methods:
              - searchByFilters: "詳細条件による店舗検索（フィルター条件の適用を最適化）"
              - filterVenues: "検索結果の詳細フィルタリング（各条件の適用状況をログ出力）"
              - sortVenues: "検索結果のソート（評価順・距離順）"
              - _convertBudgetToPriceLevel: "予算をGoogle Places APIの価格レベルに変換（変換ロジックを最適化）"
              - _filterByBusinessHours: "営業時間による詳細フィルタリング"
              - _filterByFacilities: "設備（喫煙・個室など）による詳細フィルタリング"
              - _filterByCapacity: "収容人数による詳細フィルタリング"

          favorite_service.dart:
            content: "お気に入り店舗の管理"
            dependency:
              - lib/backend/supabase/favorite_queries.dart

          location_service.dart:
            content: "位置情報の取得と処理"
            dependency: []

        api:
          places_api.dart:
            content: "Google Places APIクライアント"
            dependency:
              - lib/config/env.dart
              - lib/models/venue.dart
              - lib/models/location.dart
              - package:http/http.dart
            methods:
              - searchByText: "テキスト検索で店舗を検索（エリア・駅名、キーワード）"
              - searchByFilters: |
                "詳細条件による店舗検索
                - エリア・駅名をベースに検索
                - 以下の条件でフィルタリング
                  - types（カテゴリ）
                  - maxprice（予算上限）
                  - minprice（予算下限）
                  - opennow（営業中）
                - 検索結果の最適化
                  - ranking（評価順）
                  - distance（距離順）
                - 詳細情報の取得と処理
                  - 店舗詳細情報の一括取得
                  - 詳細情報に基づくフィルタリング
                  - エラー発生時の適切なハンドリング"
              - getPlaceDetails: "店舗の詳細情報を取得（営業時間、設備など）"
              - getPlacePhoto: "店舗の写真を取得（photoReferenceを使用）"
              - _enrichVenueWithDetails: "店舗情報に詳細データを追加（フィルタリングに必要な情報を収集）"
              - _filterVenuesByDetails: "詳細情報に基づく高度なフィルタリング"

        screens:
          home_screen.dart:
            content: "ホーム画面の実装（エリア検索、詳細検索ボタン、現在地検索ボタン、おすすめ店舗リスト）"
            dependency:
              - lib/widgets/search_bar.dart
              - lib/widgets/store_card.dart
              - lib/screens/search_screen.dart
              - lib/screens/search_result_screen.dart
              - lib/services/store_service.dart
              - lib/widgets/search_button.dart
              - lib/models/venue.dart

          search_screen.dart:
            content: |
              "詳細検索画面の実装
              - 画面構成
                - カテゴリ選択（複数選択可能、カテゴリ編集機能準備）
                - 詳細条件
                  - エリア・駅名入力
                  - 人数選択（1〜8人）
                  - 喫煙（指定なし・喫煙可・禁煙）
                  - オプション（飲み放題・個室）
                  - 営業時間（指定なし・今営業中・深夜営業あり）
                  - 予算（2,000円〜10,000円以上の範囲指定）
                - 検索ボタン
              - 機能
                - 検索条件の収集と保持
                - SearchServiceを使用した検索の実行
                - 検索中のローディング表示
                - エラー時のエラーメッセージ表示
                - 検索結果をSearchResultScreenに渡して画面遷移"
            dependency:
              - lib/widgets/search_filter.dart
              - lib/widgets/category_buttons.dart
              - lib/screens/search_result_screen.dart
              - lib/services/search_service.dart
            methods:
              - _handleSearch: "検索条件を元に検索を実行し、結果画面に遷移"
              - _showError: "エラーメッセージをSnackBarで表示"

          search_result_screen.dart:
            content: "検索結果の店舗リストと地図表示、表示切替機能（リスト表示がデフォルト）"
            dependency:
              - lib/widgets/store_card.dart
              - lib/screens/store_detail_screen.dart
              - lib/services/location_service.dart
              - lib/models/venue.dart

          store_detail_screen.dart:
            content: |
              "店舗の詳細情報表示画面
              - 基本情報（店名、住所、電話番号、営業時間）
              - 評価情報（評価点数、レビュー数）
              - 写真ギャラリー（最大10枚）
              - 店舗の特徴（価格帯、カテゴリー、設備など）
              - お気に入り登録ボタン
              - 外部リンク（公式サイト、Google Maps）"
            dependency:
              - lib/widgets/store_gallery.dart
              - lib/models/venue.dart
              - lib/models/location.dart
              - package:url_launcher/url_launcher.dart

          auth_screen.dart:
            content: "ユーザー認証、ログイン、登録、パスワードリセット"
            dependency:
              - lib/services/auth_service.dart
              - lib/widgets/auth_form.dart

        widgets:
          search_bar.dart:
            content: "エリア検索バーのカスタムウィジェット（テキスト入力対応）"
            dependency: []

          category_buttons.dart:
            content: |
              "カテゴリ選択ボタンのグリッド
              - 複数選択可能
              - アイコンと名称の表示
              - カテゴリ編集機能の準備（現在は未実装）
              - 選択状態の視覚的フィードバック"
            dependency: []

          search_filter.dart:
            content: |
              "詳細検索条件のフィルターウィジェット
              - 統一されたセクションデザイン
              - エリア・駅名入力（テキストフィールド）
              - 人数選択（ドロップダウン、1〜8人）
              - 喫煙（ラジオボタン、指定なし・喫煙可・禁煙）
              - オプション（チェックボックス、飲み放題・個室）
              - 営業時間（ラジオボタン、指定なし・今営業中・深夜営業あり）
              - 予算（レンジスライダー、2,000円〜10,000円以上）"
            dependency: []

          store_card.dart:
            content: "店舗情報を表示するカードウィジェット（店名、評価、カテゴリ、住所、写真）"
            dependency:
              - lib/models/venue.dart
              - lib/api/places_api.dart
              - lib/widgets/store_gallery.dart
            methods:
              - build: "カードウィジェットの構築"
              - buildImage: "店舗写真の表示（StoreGalleryを使用）"
              - buildInfo: "店舗情報の表示（店名、評価、カテゴリ）"

          store_gallery.dart:
            content: "店舗画像のスワイプ可能なギャラリー（写真の取得と表示を担当）"
            dependency:
              - lib/api/places_api.dart
              - lib/models/venue.dart
            methods:
              - loadPhotos: "写真の非同期読み込み"
              - buildPhotoView: "写真表示用のウィジェットを構築"

          auth_form.dart:
            content: "認証フォームのカスタムウィジェット"
            dependency: []

          search_button.dart:
            content: "詳細検索ボタンのカスタムウィジェット"
            dependency: []

        backend:
          supabase:
            auth_functions.dart:
              content: "Supabase認証関数"
              dependency: []

            store_queries.dart:
              content: "店舗情報のデータベースクエリ"
              dependency: []

            search_queries.dart:
              content: "検索クエリの実装"
              dependency: []

            favorite_queries.dart:
              content: "お気に入り機能のクエリ"
              dependency: []