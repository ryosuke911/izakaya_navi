src:
  mobile:
    izakaya_navi:
      lib:
        main.dart:
          content: "アプリのエントリーポイント、初期設定と全体のルーティング"
          dependency:
            - lib/screens/home_screen.dart
            - lib/screens/auth_screen.dart
            - lib/services/navigation_service.dart
            - lib/config/env.dart

        config:
          env.dart:
            content: "環境変数の定義（ホットペッパーAPIキー）"
            dependency: []

        models:
          venue.dart:
            content: "店舗情報のデータモデル"
            dependency: []
          
          location.dart:
            content: "位置情報のデータモデル"
            dependency: []

          hotpepper:
            shop.dart:
              content: "ホットペッパーAPIのレスポンス用モデル"
              dependency: []
              properties:
                - id: "店舗ID"
                - name: "店舗名"
                - address: "住所"
                - lat: "緯度"
                - lng: "経度"
                - access: "アクセス情報"
                - open: "営業時間"
                - close: "定休日"
                - photo: "店舗写真情報"
                - genre: "ジャンル情報"
                - budget: "予算情報"
                - capacity: "総席数"
                - party_capacity: "収容人数"
                - wifi: "Wi-Fi有無"
                - private_room: "個室有無"
                - smoking: "喫煙情報"
                - free_drink: "飲み放題有無"
              methods:
                - fromJson: "JSONからモデルを生成"
                - toVenue: "Venueモデルへの変換"

        services:
          store_service.dart:
            content: |
              "ホットペッパーAPIを利用した店舗情報の取得・検索・管理サービス
              - 基本機能
                - キーワードによる店舗検索（ホットペッパーAPI）
                - 詳細条件による店舗検索（ホットペッパーAPI）
                - 店舗詳細情報の取得（ホットペッパーAPI）
              - 詳細検索機能
                - エリア・駅名による検索
                - カテゴリによるフィルタリング（複数選択対応）
                - 詳細条件によるフィルタリング
                  - 人数での絞り込み（party_capacity）
                  - 喫煙状況での絞り込み（smoking）
                  - オプション（飲み放題、個室）での絞り込み
                  - 営業時間での絞り込み（open）
                  - 予算範囲での絞り込み（budget）
                - 検索結果のソート機能（距離順）"
            dependency:
              - lib/api/hotpepper_api.dart
              - lib/models/venue.dart
              - lib/models/location.dart
              - lib/services/location_service.dart
              - lib/config/env.dart
            methods:
              - searchByKeyword: "キーワードによる店舗検索"
              - searchByFilters: "詳細条件による店舗検索"
              - getShopDetail: "店舗の詳細情報取得"
              - sortVenues: "検索結果のソート（距離順）"
              - _convertSmoking: "喫煙状況の条件をAPIパラメータに変換"
              - _convertOpen: "営業時間の条件をAPIパラメータに変換"
              - _convertBudget: "予算範囲をAPIパラメータに変換"
              - _convertGenres: "選択されたカテゴリをAPIパラメータに変換"

          auth_service.dart:
            content: "Supabase認証機能の実装"
            dependency:
              - lib/backend/supabase/auth_functions.dart

          favorite_service.dart:
            content: "お気に入り店舗の管理"
            dependency:
              - lib/backend/supabase/favorite_queries.dart

          location_service.dart:
            content: "位置情報の取得と処理"
            dependency: []
            methods:
              - getCurrentLocation: "現在位置の取得"
              - calculateDistance: "2地点間の距離を計算"

        api:
          hotpepper_api.dart:
            content: "ホットペッパーAPIクライアント"
            dependency:
              - lib/config/env.dart
              - lib/models/venue.dart
              - lib/models/location.dart
              - lib/models/hotpepper/shop.dart
              - package:http/http.dart
            methods:
              - searchByKeyword: "キーワードによる店舗検索"
              - searchByFilters: |
                "詳細条件による店舗検索
                - エリア・駅名をベースに検索
                - 以下の条件でフィルタリング
                  - keyword（キーワード）
                  - area（エリア）
                  - genre（ジャンル）
                  - budget（予算）
                  - party_capacity（収容人数）
                  - private_room（個室）
                  - smoking（喫煙）
                  - free_drink（飲み放題）
                  - open（営業時間）"
              - getShopDetail: "店舗の詳細情報を取得"

        screens:
          home_screen.dart:
            content: "ホーム画面の実装（エリア検索、詳細検索ボタン、現在地検索ボタン、おすすめ店舗リスト）"
            dependency:
              - lib/widgets/search_bar.dart
              - lib/widgets/store_card.dart
              - lib/screens/search_screen.dart
              - lib/screens/search_result_screen.dart
              - lib/services/store_service.dart
              - lib/widgets/search_button.dart
              - lib/models/venue.dart

          search_screen.dart:
            content: |
              "詳細検索画面の実装
              - 画面構成
                - カテゴリ選択（複数選択可能）
                - 詳細条件
                  - エリア・駅名入力
                  - 人数選択（1〜8人）
                  - 喫煙（指定なし・喫煙可・禁煙）
                  - オプション（飲み放題・個室）
                  - 営業時間（指定なし・今営業中・深夜営業あり）
                  - 予算（2,000円〜10,000円以上の範囲指定）
                - 検索ボタン
              - 機能
                - 検索条件の収集と保持
                - StoreServiceを使用した検索の実行
                - 検索中のローディング表示
                - エラー時のエラーメッセージ表示
                - 検索結果をSearchResultScreenに渡して画面遷移"
            dependency:
              - lib/widgets/search_filter.dart
              - lib/widgets/category_buttons.dart
              - lib/screens/search_result_screen.dart
              - lib/services/store_service.dart
              - lib/services/location_service.dart
            methods:
              - _handleSearch: "検索条件を元に検索を実行し、結果画面に遷移"
              - _showError: "エラーメッセージをSnackBarで表示"

          search_result_screen.dart:
            content: "検索結果の店舗リストと地図表示、表示切替機能（リスト表示がデフォルト）"
            dependency:
              - lib/widgets/store_card.dart
              - lib/screens/store_detail_screen.dart
              - lib/services/location_service.dart
              - lib/models/venue.dart

          store_detail_screen.dart:
            content: |
              "店舗の詳細情報表示画面
              - 基本情報（店名、住所、電話番号、営業時間）
              - 写真ギャラリー（最大10枚）
              - 店舗の特徴（価格帯、設備など）
              - お気に入り登録ボタン
              - 外部リンク（ホットペッパーグルメ、Google Maps）"
            dependency:
              - lib/widgets/store_gallery.dart
              - lib/models/venue.dart
              - lib/models/location.dart
              - package:url_launcher/url_launcher.dart

          auth_screen.dart:
            content: "ユーザー認証、ログイン、登録、パスワードリセット"
            dependency:
              - lib/services/auth_service.dart
              - lib/widgets/auth_form.dart

        widgets:
          search_bar.dart:
            content: "エリア検索バーのカスタムウィジェット（テキスト入力対応）"
            dependency: []

          search_filter.dart:
            content: |
              "詳細検索条件のフィルターウィジェット
              - 統一されたセクションデザイン
              - エリア・駅名入力（テキストフィールド）
              - 人数選択（ドロップダウン、1〜8人）
              - 喫煙（ラジオボタン、指定なし・喫煙可・禁煙）
              - オプション（チェックボックス、飲み放題・個室）
              - 営業時間（ラジオボタン、指定なし・今営業中・深夜営業あり）
              - 予算（レンジスライダー、2,000円〜10,000円以上）"
            dependency: []

          store_card.dart:
            content: "店舗情報を表示するカードウィジェット（店名、カテゴリ、住所、写真）"
            dependency:
              - lib/models/venue.dart
              - lib/widgets/store_gallery.dart
            methods:
              - build: "カードウィジェットの構築"
              - buildImage: "店舗写真の表示（StoreGalleryを使用）"
              - buildInfo: "店舗情報の表示（店名、カテゴリ）"

          store_gallery.dart:
            content: "店舗画像のスワイプ可能なギャラリー（写真の取得と表示を担当）"
            dependency:
              - lib/models/venue.dart
            methods:
              - loadPhotos: "写真の非同期読み込み"
              - buildPhotoView: "写真表示用のウィジェットを構築"

          auth_form.dart:
            content: "認証フォームのカスタムウィジェット"
            dependency: []

          search_button.dart:
            content: "詳細検索ボタンのカスタムウィジェット"
            dependency: []

          category_buttons.dart:
            content: |
              "カテゴリ選択ボタンのグリッド
              - 複数選択可能
              - アイコンと名称の表示
              - 選択状態の視覚的フィードバック
              - ホットペッパーAPIのジャンルに対応"
            dependency:
              - lib/models/hotpepper/genre.dart

        backend:
          supabase:
            auth_functions.dart:
              content: "Supabase認証関数"
              dependency: []

            store_queries.dart:
              content: "店舗情報のデータベースクエリ"
              dependency: []

            search_queries.dart:
              content: "検索クエリの実装"
              dependency: []

            favorite_queries.dart:
              content: "お気に入り機能のクエリ"
              dependency: []